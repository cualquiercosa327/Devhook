　devhook V0.52.0100 By BOOSTER

　FW1.50のPSPで、新しいFWを動作させる為のドライバー＆ツールです。

 devhook V0.52.0000に対する差分ファイルのみ収録しています。
 devhook V0.52.0000へファイルを上書きして使用してください。

-----------------------------
おことわり
-----------------------------
・devhookは、この「おことわり」の制限に従う場合にフリーウェアとして自由に使用
　できます。devhookは無料で誰でも入手可能なので、売ったり買ったりしないでくだ
　さい。

・devhookは無保証です。作者は本プログラムの動作結果、著作権等の利権問題を含む
　すべての事柄に対して一切の保障をいたしません。
　devhookの使用とその結果については、使用者自身が責任を負うことになります。

・devhookの改造、変造、追加は自由ですが、devhookの一部または全部を含む場合は
　誰でも入手できる場所に公開して下さい。限定された有料会員制サイトに限定
　して配布する等はしてはいけません。
　　devhookを一切含まない差分パッチや追加ファイルは、この制限の対象外です。

・devhookはユーザーの使用環境を快適にする目的で作られていますが、著作権侵害
　を助長する目的で使用してはいけません。
　　不法に配布されるUMDイメージファイル等に同梱する行為は、これに該当します。

・これらの事柄に合意できない方はdevhookを使用してはいけません。

・fbm描画ルーチン及び各種フォントファイルは、mok氏のDH046_mok04aから合流させて
　いただいています。各種フォントファイルの扱いは、各フォントファイルのライセ
　ンスに従ってください。
　　launcherに含まれるfbmアクセスプログラムについては、DH046_mok04aのライセン
　スも適用されます。
　これらのドキュメントとライセンスはOriginal Docs内に情報があります。

-----------------------------
周知の問題点
-----------------------------
・vshex(XMB上の設定画面）が、時々ちらつくことがある。
・ランチャからリブートしない場合がある。
・XMBからUMDゲーム起動時、起動画面で停止することがある。
・UMDゲームなどからXMBに戻らないことがある。
・クロック変更＆UMD AUTORUN起動の時、UMD起動後にロックすることがある

-----------------------------
V0.52.0000 -> V0.52.0100　変更点
-----------------------------
・FW3.11ブート対応

-----------------------------
devhookで実行するファームウェアについて
-----------------------------
　PSPのメーカーは、正規の方法以外でのアップデートは行わないように推奨しています。
　以下、システムアップデート３．０２のホームページから転記、
「当社がネットワーク経由またはUMDでご提供する正式なアップデートデータ以外のご使用や、当社からお知らせする方法以外でのアップデートは行わないよう、ご注意下さい。不正な状態で本体機能の更新を行った場合、動作保証を行わないだけでなく、修理および保証の対象外となります。」

　devhookはPSPをアップデートすることなくメモステ上の最新ファームウェアを起動するツールなので、
flash0/flash1を使用しない状態であれば、上記「当社からお知らせする方法以外でのアップデート」
には該当しないと思われますが、devhookによるFWファイルの使用については、各自の自己判断の上で、
自己責任において使用して下さい。


　devhookで最新FWを実行する為には、別途ファームウェアファイルをインストールする
必要があります。
　FWのインストールは、別途"PSARDumper_303"等で解凍したFWファイルを、所定の位置
に移動する必要があります。
　"fwinstall.txt"に概要がありますが詳細説明は割愛してますので、方法は分からなければ、
旧バージョンのdevhookのドキュメントやweb上の情報サイトから情報を収集して下さい。

　Ver.0.52.0100における正式サポートFWは2.71,2.80,2.82,3.02,3.03,3.10です。
　1.50 NOUMDは削除されましたが、FW 1,50,2.00,2.50,2.60,3.00,3.01についてはコードが
残っていますが未確認です。動作可否の確認と判断は各自でお願いします。

　flash1のインストールは少々危険ですが、軽〜く推奨します。
　以前flash1のインストールなしでは、XMBの特定の動作でメモステ内のファイルが破壊
される不具合が発生していました。この不具合は修正されましたが、完全かどうかのテス
トは十分に行われていません。
　破壊が発生したかどうかは、PCにUSB接続してコマンドプロンプトから"chkdsk"を実行
すると分かります。

-----------------------------
todo
-----------------------------

・flashフォーマットのブロック

・VSHEXの多言語対応、FW/ドライバ設定変更
　多言語化には、ダイレクトプリントをフレームバッファへ変更する必要があります。
　「テスト版」と書かなくなる頃に実装していたいと思う。

・ランチャメニューのスクリプト言語
　かなり中途半端な文法となっている簡易スクリプト言語、Ｃ言語ライクに変更したい。

・NO-UMD for FW2.xx
　長らく保留：今のフック位置では、対応が大変そうなので

・NAND driver level emulation
　またもや保留。3.01も現行のflashフックで動いてしまったので。

・clean boot from IPL image
　PSP最後の砦（本当の根っこはrecovery mode boot)

-----------------------------
伝言、メモ
-----------------------------

　flash1の利用はメモステ破壊とレジストリの速度向上に効果があります＞危険度小
　flash0のフォント利用は、webブラウザの速度向上が顕著です＞危険度中

　Dark Alex氏のSpecialEditionなど、内蔵flashを書き換える他のソフトと併用される場合、
devhookのFWインストールを一番最後に行いましょう。

　XMB上のvshex設定メニューの操作方法は

　HOME  : メニューのＯＮ／ＯＦＦ
　UP    : 上の項目へ
　DOWN  : 下の項目へ
  LEFT  : 前へ設定変更（即決定）
  RIGHT : 次へ設定変更（即決定）
  CIRCLE: 決定

　キー割り当てを変更したければ、SDKからvshexをリビルドしてください。

-----------------------------
セットアップ
-----------------------------

1.devhookの"MS_ROOT/"を、"ms0:/"にコピーします。

2.fwinstall.txtにしたがってfirnwareファイルをセットアップします。

3.必要があれば、"/ISO"にUMD ISOファイルを置きます。

　詳細説明、これから充実してくであろうweb上の情報サイトをご活用下さい。

-----------------------------
一般的な使い方
-----------------------------

FW1.50のPSPからdevhook launcherを起動します。

ランチャーメニュー上で設定を切り換えます。

"START"でDEVHOOKが起動した状態で設定FWのXMBが再起動します。

vshexメニューが表示された状態で起動します。
（表示されない設定の場合は、HOMEキーを押します）

方向キーでdevhookの各種設定を行います。

HOMEキーを押してvshexメニューを終了させます。

XMBの操作でUMDやMS上のアプリケーションを起動します。

XMBの操作でUMDやMS上のアプリケーションを起動します。


devhook動作中はメモステを交換しないようにします。

PSP内蔵FWに戻るときは、vshexメニューの"REBOOT without DEVHOOK"を
選び、"Yes"を選択するか、電源キーを長押しして一度電源を切ります。

-----------------------------
更新履歴 HISTRY
-----------------------------

-----------------------------
V0.51.0100 -> V0.52.0000　変更点
-----------------------------
・FW3.03ブート
・リブート時のユーザモジュール終了手順を変更（改善？）
・umdエミュのパス最大文字数を63から127に増加
・UMDISO,vshexにstopmoduleエントリを実装
・bootconfファイルをCFGディレクトリに移動
・ランチャにPSAR Dumperの出力からFWをセットアップする機能を追加

-----------------------------
V0.51.0000 -> V0.51.0100　変更点
-----------------------------
・flash1をインストールしない時のメモステファイルが破壊する不具合を修正
・flash1をインストールしない時のレジストリ初期化繰り返しの不具合を修正
　"f0/kd/lflash_fatfmt.prx"は削除かリネームしておきましょう。
・vshem：MENU on BOOTがOFFにならないバグ修正
・日本語のインストールメニューが動作しない不具合修正（ファイル差し替え）
・FW3.02ディレクトリとメニュー追加、flash1ワークを3.0xで共有化
　FW3.02が動くとの情報で追加しましたが、BOOSTERは未確認です。
・umdcisoがISOアクセスのLOGを吐くモードになっていたのを修正。

-----------------------------
V0.50.0000 -> V0.51.0000　変更点
-----------------------------

・メモステアクセスの基本的機能が起動していなかったバグを修正 > webブラウザ他、XMB全般
・FW3.01起動対応
・FW2.80+でCLOCK切り替えの時、フリーズする不具合修正
・FW2.80+のaudio.prx差し替えが不要
・DH0.46と共存可能
・ランチャーを変更、スクリプトの強化とmok氏のfbmprintシステムとマルチ言語対応
・XMB上でDEVHOOKを終了させる機能("ESCAPE the DEVHOOK")が機能回復（未修正）

-----------------------------
V0.46.0000 -> V0.50.0000　変更点
-----------------------------
・追加：vshex(XMB)にGUIインターフェースと各種設定機能 (HOME key)
・追加：再起動なしでUMD Disc/ISOの切り換えに対応
・追加：FW2.80/2.82の起動を暫定的にサポート

・ソースのクリーンアップ
・削除：1.50,2.00,2.50,2.60をサポートから除外
・削除：1.50用NOUMDを排除
・変更：devhookのAPIを大幅変更、簡易レジストリシステム追加
・変更：ランチャを新インターフェースに対応、メニュー整理
・変更：ランチャの設定ファイルの構造変更
・追加："DEVHOOK Ver.0.46 - modified by mok r04a"からフォントシステムや
　　　　他のドライバ等を勝手にマージ

-----------------------------
V0.45.0000 -> V0.46.0000　変更点
-----------------------------
・FlashエミュからメモステとPSP内蔵flashROMを併用する機能を実装
・メモステファイル破壊不具合の対策
・FW2.xxからノーマルFWへ戻れなかった不具合を修正
・"flash0:"の書き込みモードでのマウントを禁止

・ランチャのメニュー構成を大きく変更
・英語ランチャを元の英数フォントに戻した。
・ランチャに内蔵FlashROMの管理機能を追加（MSへのFWインスト機能は無し）
・ランチャに自動起動時間設定機能を追加 > "MS_ROOT/dh/autorun.ini"を参照

・FW2.xxのdevhookからdevhookを終了するアプリ同梱
・cisoのコマ落ち対策版"umdciso_P47_SS_2000.prx"を同梱
　PRIORITY=47 , SHORT SLEEP,ciso buf=0x2000という設定です。
　"umdciso.prx"と差し替えて使います。
-----------------------------
V0.44.0000 -> V0.45.0000　変更点
-----------------------------
・ELF形式の、メモステEBOOT.PBPとUMD(ISO) EBOOT.BINの起動をサポート
・1.50 NOUMDが動かなかった不具合修正
・Flashエミュに排他制御追加、他メモステ破壊対策をいくつか
・reboot時のメモリマップを変更
-----------------------------
V0.43.0101 -> V0.44.0000　変更点
-----------------------------
・FW2.71リブート暫定対応
・/dh/kd/reboot.bin無しの時、ランチャ−終了でフリーズする不具合修正
・Flashエミュファイル数増加＞フリーズ対策
・その他、細かな変更
-----------------------------
V0.43.0100 -> V0.43.0101　変更点
-----------------------------
・ファイルアクセス時のスタック数増加＞ FW2.60-333MHz-ブラウザのフリーズ対策
・クロック変更を、起動後５秒間抑制＞333MHzでXMBに戻れない不具合対策
※バージョンコードの変更はこれ以後省略
-----------------------------
V0.43 -> V0.43.0101　変更点
-----------------------------
・メモステ上のファイルが壊れる不具合の対策
・dhGetVersion()の戻り値 0x00430000 -> 0x00430100
・ソースcleanup
-----------------------------
V0.42b -> V0.43　変更点
-----------------------------
・FW2.60起動をサポート(インストーラは一部未対応です）
・リブート時のロードアドレスをユーザ指定可能に変更
・UMDリードのコールバックを１セクタから複数セクタに変更
・dhGetVersion()の戻り値 0x00420002 -> 0x00430000
・ランチャ起動時にdevhookをロードするように変更
・ランチャ変更、0.42b/0.43新設定、メニュー構成、表示レイアウト
・plain20.prxとplain25.prxをplain2x.prxに統合
・flashEMU時にstackを追加
・リブート時、devhookを終了できるショートカットキーの機能追加
・0.42bでクロック設定がされなかったバグを修正
-----------------------------
V0.42a -> V0.42b　変更点
-----------------------------
・リブート時のメモリの扱いを改善
・devhook常駐タスクのスタック4KB->8KB
・dhGetVersion()の戻り値 0x00004201 -> 0x00420002
・CPU CLOCK=0指定時、devhookによるCLOCK制御を禁止(ランチャ未対応）
-----------------------------
V0.42 -> V0.42a　変更点
-----------------------------
・NOUMDのバグフィクス
・dhGetVersion()の戻り値 0x00004200 -> 0x00420001
-----------------------------
V0.41d -> V0.42　変更点
-----------------------------
・NOUMDのバグフィクス
・UMD emuのsemaphoreのバグフィクス
・CLOCKをresetするポイントを変更
・コンフィグデータの内容変更
・ランチャからのロード、設定方法を変更
・起動時のconfigロードをファイルからメモリ経由に変更
・ISOイメージの整合性の判定を追加
・ISO/CSOドライバを別モジュールに分離
・XMBのUMD切り替えを別モジュールに分離
・XMBのショートカットにCLOCK切り替え機能を追加
・XMBでISOイメージ、CLOCK周波数の表示機能追加
・リモコン端子へのKprintf抑制スイッチ追加でリモコン対応
・日本語ローカライズ版ランチャー追加(日本語対応＆ライブラリ提供：mok様)
・他、細かな変更多数
-----------------------------
V0.41c -> V0.41d　修正点
-----------------------------
・2.00/2.50でloadModule時、不正メモリアクセスのバグ修正
　フリーズしてた物、改善の可能性あり。
・UMD使用時も"UMD VERSION"スイッチを有効にした。
-----------------------------
V0.41b -> V0.41c　修正点
-----------------------------
・一定条件の時、ciso readで別の場所をリードしてしまうバグ修正
　V0.41bのみで発生したバグです。
-----------------------------
V0.41a -> V0.41b　変更点
-----------------------------
・msrebootパッチコードをexportして常駐サイズが減少させた。
  "ms0:/dh/kd/msreboot.bin"というファイルが増えました。
・launcherがMODされているようなのでソースを添付
　AUTORUN待ち時間変更 1sec -> 3secに変更
・umd read時のスタック拡張サイズ 0x800 -> 0x1000
　一部の不動MSで、動くようになるとよいのですが．．．
 他、ciso readルーチンを多少変更
-----------------------------
V0.41 -> V0.41a　修正点
-----------------------------
・レジューム後壁紙が真っ黒になる不具合修正
・ANYUMDでISO切り替えの不具合修正
-----------------------------
V0.40 -> V0.41　変更点
-----------------------------
・FW2.50リブート対応
・plain20.prxの対応ロード位置を変更
・UMD READのスタック拡張位置を移動->FW2.50対応
-----------------------------
V0.32a -> V0.40　変更点
-----------------------------
・FW2.00リブートのサポート
  FW2.00のrebootがサポートされました。
  FW1.00のPSPでは、また使えなくなりました。
・新ANY-UMDの追加
  既存のNO-UMDは2.00以降では動作しないため、新しく実装しました。
　現在ANY-UMDまでなので、FW2.00でISOファイルをマウントするには、
ダミーのUMDディスクを挿入する必要があります。
・flashエミュレーション時のfdを自動的に切り詰めるようにしました。
　2.00webブラウザにおけるフリーズ対策です。
・ランチャ起動時、前回の設定値をデフォルトにするように変更
　起動後、１秒以内に'O'を押さないと、前回設定で自動的に実行されます。
・FW1.50 NOUMDにおけるUMD切り替えの修正
-----------------------------
V0.32 -> V0.32a　修正点
-----------------------------
・セマフォ未初期化バグフィクス 
  for 太鼓の達人・・・というか基本的な潜伏バグの修正
・ISOマウントをMSの抜き指しに対応
・各種小修正とシェイプアップ
-----------------------------
V0.31 -> V0.32　変更点
-----------------------------
・圧縮ISOイメージ（*.CSO)対応
・MXB上で、ISOイメージの切り換え機能追加
・CSO対応に伴い、ISO READシーケンスをセクタ単位に構造変更
　何処か壊したかも．．．
・ISO ACCESS時のSTACK追加方法変更
・サイズ増加・・・フリーズの確立が増えたかも。
-----------------------------
V0.30a　変更点
-----------------------------
・サイズ800Hを超えるリードが全てエラーになるバグを修正
　みんごる対応・・・というか根本的なバグ。
・FLASHエミュレーションの暫定追加
　MPH FW14のソースを参考にしました。Thanks->MPH
　まだFW1.50しかブート出来ないため、現状では壁紙変えたり
設定データ差し替えるくらいにしか使えません。
　エミュモードを使うには/150/flash0,/150/flash1に
flasah0:とflash1:の完全ファイルコピーを取ったあと、
メニューの"FW1.50(emulation)"を選べば動きます。
・みんごる終了できなかったため、リブート時のprxロードアドレス変更
・アップデータが起動しないようにpspbtcnf_updater.txtを空にした
Ver.0.30pre
  - DKをdevkitPSP release7に移行
  -devhookをprxモデルに変更,ロードにはplane prxパッチが必要です。
    "pspSdkInstallNoPlainModuleCheckPatch()"
  -OSリブートによるdevhook読み込み動作をサポート
　-FW1.00未サポート、FW1.50に拘束
  -wipeout pure freeze probremのバグ修正
・FEP部分のソースを公開
　お願いです。どなたか、使い易い、カッコいいGUIを作ってください。
・IGRリセット、クロック切り替えは暫定的に禁止してあります。
　（自作prxを組み込むことで、各人、いろいろ拡張できます）
　-構造的変更
Ver.0.22
　サスペンドレジュームのサポート、UMD EMULATOR 0.8互換ディレクトリ、
バージョンチェック迂回でUMD起動 
  -added open/close ISO file at each UMD access.
   *supported suspend/resume.
  -added ISO search directry "fatms0:/UMDEMULATOR/ISO".
   *UMD EMULATOR 0.8 compatible.
  -added "UMD Disc" item and removed "UMD MODE" menu.
   *with bypass version check.
Ver.0.21
  -added LoadExec() emulation
    *SAPCE INVADER POCKET
  -InGameReturn (L+R+Start)
  -sceUmdGetDiscInfo() emulation.
Ver.0.20
  -fix forget sceIoClose() when close function of "umd?:" RAW access.
    *SHUTOKOU BATTLE
  -fix sceUmdActivate() and added sceUmdDeactivate() handling.
    *MAJONG FIGHT CLUB
  -support target file path
    *work with hook_boot 0.94.(for analyze,FW hack,etc.)
  -Added InGameReset
    L+R +HOME : return to MXB
Ver.0.10
 1st test release
